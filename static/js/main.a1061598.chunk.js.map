{"version":3,"sources":["components/tile/Tile.js","components/score/ScoreBoard.js","components/restart/RestartButton.js","components/board/board_functions.js","components/board/Board.js","App.js","index.js"],"names":["Tile","props","className","style","backgroundColor","Math","floor","value","ScoreBoard","score","highscore","RestartButton","onClick","clickHandler","initiateBoard","addRandomTile","Array","fill","zerosToBottom","a","b","transposeMatrix","arr","map","_","colIndex","row","handleCollisions","direction","dir","reverse","i","length","newValue","getEmptyTilesIndexes","tiles","emptyTilesIndexes","forEach","item","index","push","makeRows","flatArr","rows","slice","getRandom","random","no","tilesFlatArray","concat","emptyTiles","randTileIndex","randValue","GameOverDiv","status","Board","useState","setTiles","setScore","gameStatus","setGameStatus","localStorage","getItem","highScore","setHighScore","increaseScore","keyPressHandler","e","prevTiles","newTiles","moveScore","key","increaseScoreFunction","collided","tempScore","sort","move","nothingHappened","every","tile","useEffect","document","addEventListener","removeEventListener","includes","checkGameStatus","setItem","row_index","toString","renderRow","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a1061598.chunk.js","sourcesContent":["function Tile(props) {\n    const colors = {\n        0: '#ffff99',\n        1: '#ffff33',\n        2: '#ffad33',\n        4: '#d86400',\n        8: '#de4000'\n    }\n\n    return (\n        <div \n            className=\"tile\" \n            style={{backgroundColor: colors[Math.floor(props.value % 15)]}}>\n            {(props.value > 0) ? props.value : ''}\n        </div>\n    )\n}\n\nexport default Tile;","function ScoreBoard( {score, highscore} ) {\n    return (\n        <div className=\"score\">\n            <div style={{'float':'left'}}>\n                <h3>Score: {score}</h3>\n            </div>\n            <div style={{'float':'right'}}>\n            \t<h3>Highscore: {highscore}</h3>\n            </div>\n        </div>\n    )\n}\n\nexport default ScoreBoard;","function RestartButton(props) {\n        return (\n            <button onClick={props.clickHandler}>\n                Restart\n            </button>\n            )\n}\n\nexport default RestartButton;","function initiateBoard() {\n    const tiles = Array(4).fill(Array(4).fill(0))\n    return addRandomTile(tiles, 2)\n}\n\n\nfunction zerosToBottom(a, b) {\n    // Callback-function for array.sort()\n    // If a tile value is greater than 0, it gets sorted to a higher index,\n    // and vice versa. \n    if (a !== 0 && b === 0) {\n        return 1;\n    }\n    else if (a === 0 && b !== 0) {\n        return -1;\n    }\n    else {\n        return 0;\n    }\n}\n\n\nfunction transposeMatrix(arr) {\n    return arr[0].map((_,colIndex) => arr.map((row) => row[colIndex]));\n}\n\n\nfunction move(tiles, direction, increaseScoreFunction) {\n    let collided = [];\n    let tempScore = 0;\n    let moveScore = 0;\n    \n    // Transpose board\n    if (direction === 'ArrowUp' || direction === 'ArrowDown'){\n        tiles = transposeMatrix(tiles)\n        }\n\n    if (direction === 'ArrowRight' || direction === 'ArrowDown') {\n        // Move, collide, move again to cover up empty spaces.\n        tiles = tiles.map((row) => {\n            row.sort(zerosToBottom);\n            [collided, tempScore] = handleCollisions(row, 'ArrowRight', increaseScoreFunction)\n            moveScore += tempScore;\n            collided.sort(zerosToBottom)\n            return collided;\n        });\n    }\n\n    else if (direction === 'ArrowLeft' || direction === 'ArrowUp') {\n        tiles = tiles.map((row) => {\n            // Reverse row first so same sorting algorithm can be used.\n            // Move, collide, move again to cover up empty spaces.\n            row.reverse();\n            row.sort(zerosToBottom);\n            [collided, tempScore] = handleCollisions(row, 'ArrowLeft', increaseScoreFunction)\n            moveScore += tempScore;\n            collided.sort(zerosToBottom)\n            collided.reverse()\n            return collided;\n        });\n    }\n\n    // Transpose it back again\n    if (direction === 'ArrowUp' || direction === 'ArrowDown'){\n        tiles = transposeMatrix(tiles)\n        }\n\n    return [tiles, moveScore];\n}\n\n\nfunction handleCollisions(row, direction) {\n    // Iterate over row in opposite direction of player's move. Adjacent \n    // tiles with the same value gets added up and assigned to the tile\n    // farthes away in the direction of the move. The other is set to 0.\n    let dir = 1;\n    let score = 0;\n    \n    if (direction === 'ArrowRight' || direction === 'ArrowDown') {\n        row.reverse()\n        dir = -1\n    }\n\n    for (var i = 0; i<row.length; i++) {\n\n        if ((row[i] === row[i+dir]) && (row[i] > 0)) {\n            let newValue = row[i] + row[i+dir];\n            row[i] = newValue;\n            row[i+dir] = 0;\n            score += newValue;\n        }\n    }\n\n    if (direction === 'ArrowRight' || direction === 'ArrowDown') {\n        row.reverse()\n    }\n\n    return [row, score];\n}\n\n\nfunction getEmptyTilesIndexes(tiles) {\n    const emptyTilesIndexes = [];\n\n    tiles.forEach((item, index) => {\n        if (item === 0) {\n            emptyTilesIndexes.push(index);\n        }\n    });\n\n    return emptyTilesIndexes;\n}\n\n\nfunction makeRows(flatArr) {\n    const rows = [];\n    let i;\n\n    for (i=0; i<flatArr.length; i+=4) {\n        rows.push(flatArr.slice(i, i+4));\n        }\n    return rows;\n}\n\n\nfunction getRandom(arr) {\n    return arr[Math.floor(Math.random() * arr.length)];\n}\n    \n\nfunction addRandomTile(tiles, no=1) {        \n    const tilesFlatArray = [].concat(...tiles);\n    for (let i = 0; i < no; i++){\n        const emptyTiles = getEmptyTilesIndexes(tilesFlatArray);\n        const randTileIndex = getRandom(emptyTiles);\n        const randValue = getRandom([2,4]); // The random added tile should have a value of 2 or 4.\n\n        tilesFlatArray[randTileIndex] = randValue;\n    }\n\n    tiles = makeRows(tilesFlatArray);\n\n    return tiles;\n}\n\n\nexport {\n    initiateBoard,\n    zerosToBottom,\n    transposeMatrix,\n    move,\n    handleCollisions,\n    getEmptyTilesIndexes,\n    makeRows,\n    getRandom,\n    addRandomTile\n}\n","import { useState, useEffect } from 'react';\nimport Tile from '../tile/Tile';\nimport ScoreBoard from '../score/ScoreBoard';\nimport RestartButton from '../restart/RestartButton';\nimport { initiateBoard, move, getEmptyTilesIndexes, addRandomTile } from './board_functions'\n\nfunction GameOverDiv( {status} ) {\n    return (\n        <div className='gameOver' >\n            <h1>{(status === 'won') ? 'youHaveWonOU WON!': 'GAME OVER'}</h1>\n        </div>\n    )\n}\n\nfunction Board(props) {\n\n// SETUP\n// =====\n\n    const [tiles, setTiles] = useState(initiateBoard());\n    const [score, setScore] = useState(0);\n    const [gameStatus, setGameStatus] = useState(false);\n    const [highScore, setHighScore] = useState( () => localStorage.getItem('2048_highscore') || 0 );\n\n    useEffect( () => {\n        if (gameStatus === false){\n            document.addEventListener('keydown', keyPressHandler);\n        }\n\n        return () => {\n            document.removeEventListener('keydown', keyPressHandler);\n        }\n    })\n\n    useEffect( () => {\n        checkGameStatus(tiles);  \n        setHighScore( (score > highScore) ? score : highScore )\n    }, [tiles])\n\n    useEffect( () => {\n        localStorage.setItem('2048_highscore', highScore);\n    },[highScore])\n\n// =====\n\n\n    function increaseScore(value) {\n        setScore(score + value);\n    }\n\n    function checkGameStatus(tiles) {\n        const tilesFlatArray = [].concat(...tiles);\n        const emptyTiles = getEmptyTilesIndexes(tilesFlatArray)\n        if (emptyTiles.length < 1) {\n            setGameStatus('lost');\n        }\n        if (tilesFlatArray.includes(2048)) {\n            setGameStatus('won')\n        }\n    }\n\n    function keyPressHandler(e) {\n        const prevTiles = [].concat(...tiles);\n        let newTiles = [];\n        let moveScore = 0;\n\n        switch(e.key) {\n            case \"ArrowUp\":\n            case \"ArrowDown\":\n            case \"ArrowLeft\":\n            case \"ArrowRight\":\n                [newTiles, moveScore] = move(tiles, e.key, increaseScore)\n                break;\n\n            default:\n                return;\n        }\n\n        // Check if move changed board. If so, add new random tile.\n        const nothingHappened = prevTiles.every( (tile, index) => tile === [].concat(...newTiles)[index] );\n        newTiles = nothingHappened ? newTiles : addRandomTile(newTiles);\n        \n        increaseScore(moveScore);\n        setTiles([...newTiles]);\n    }\n\n    function restartHandler() {\n        setGameStatus(false);\n        setScore(0);\n        setTiles(initiateBoard());\n    }\n\n    function renderRow(row, row_index) {\n        return (\n            <tr key={row_index} className=\"row\">\n                {row.map((tile, i) => <td key={i.toString()}><Tile value={tile} /></td>)}\n            </tr>\n        )\n    }\n\n    return (\n        <div className=\"container\">\n            <ScoreBoard score={score} highscore={highScore} />\n            <div className=\"board\">\n                {(gameStatus !== false) ? <GameOverDiv status={gameStatus} /> : null}\n                <table className=\"table\">\n                    <tbody>\n                        {tiles.map((row, i) => renderRow(row, i))}\n                    </tbody>\n                </table>\n            </div>\n            {(gameStatus !== false) ? <RestartButton clickHandler={restartHandler} /> : null}\n        </div>\n    );\n}\n\nexport default Board;\n","import React from 'react';\n\nimport './App.css';\nimport Board from './components/board/Board';\n\n\nfunction App() {\n    return (\n        <div className=\"App\">\n            <Board />\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}